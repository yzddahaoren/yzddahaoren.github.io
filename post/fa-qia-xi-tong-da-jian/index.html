<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>发卡系统搭建 | yzd-gridea</title>
<meta name="description" content="记录 :  思考 : 慎言">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://g.yzddhr.me/favicon.ico?v=1566346908906">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://g.yzddhr.me/styles/main.css">


  
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
  

  


<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>

<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />



  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://g.yzddhr.me">
        <img src="https://g.yzddhr.me/images/avatar.png?v=1566346908906" class="site-logo">
        <h1 class="site-title">yzd-gridea</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            首页
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            归档
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            标签
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            关于
          </a>
        
      
        
          <a href="/tag/9CTakvPYn/" class="site-nav">
            音乐
          </a>
        
      
        
          <a href="https://g.yzddhr.me/post/friends/" class="site-nav">
            友链
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
          <a class="social-link" href="https://github.com/yzddahaoren" target="_blank">
            <i class="fab fa-github"></i>
          </a>
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      记录 :  思考 : 慎言
    </div>
    <div class="site-footer">
      Powered by <a href="https://github.com/yzddahaoren" target="_blank">yzddhr@2019</a> | <a class="rss" href="https://g.yzddhr.me/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">发卡系统搭建</h2>
            <div class="post-date">2019-08-19</div>
            
              <div class="feature-container" style="background-image: url('https://g.yzddhr.me/post-images/fa-qia-xi-tong-da-jian.jpg')">
              </div>
            
            <div class="post-content">
              <p><img src="https://img.hacpai.com/bing/20190220.jpg?imageView2/1/w/960/h/540/interlace/1/q/100" alt=""></p>
<p>使用项目搭建自己的发卡系统</p>
<blockquote>
<p>项目地址:<br>
<a href="https://github.com/zlkbdotnet/zfaka">https://github.com/zlkbdotnet/zfaka</a></p>
</blockquote>
<p>本文使用的是基于docker搭建</p>
<h2 id="环境">环境</h2>
<ul>
<li>docker安装</li>
</ul>
<pre><code class="language-sh">curl -sSL https://get.docker.com/ | sh
service docker start
</code></pre>
<ul>
<li>安装docker-compose</li>
</ul>
<pre><code class="language-sh">curl -L https://github.com/docker/compose/releases/download/1.17.0/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose
chmod +x /usr/local/bin/docker-compose
</code></pre>
<p>打印信息</p>
<pre><code class="language-sh">docker --help
</code></pre>
<p>有输出表示安安装成功.</p>
<h2 id="安装">安装</h2>
<blockquote>
<p>注意不能用内存呢太小的vps,内存不够建议设置虚拟内存,可以使用以下脚本设置虚拟swap分区</p>
</blockquote>
<p><strong>脚本不支持OpenVZ架构，安装会自动退出。</strong></p>
<pre><code class="language-sh">#!/usr/bin/env bash
#Blog:https://www.moerats.com/

Green=&quot;\033[32m&quot;
Font=&quot;\033[0m&quot;
Red=&quot;\033[31m&quot; 

#root权限
root_need(){
    if [[ $EUID -ne 0 ]]; then
        echo -e &quot;${Red}Error:This script must be run as root!${Font}&quot;
        exit 1
    fi
}

#检测ovz
ovz_no(){
    if [[ -d &quot;/proc/vz&quot; ]]; then
        echo -e &quot;${Red}Your VPS is based on OpenVZ，not supported!${Font}&quot;
        exit 1
    fi
}

add_swap(){
echo -e &quot;${Green}请输入需要添加的swap，建议为内存的2倍！${Font}&quot;
read -p &quot;请输入swap数值:&quot; swapsize

#检查是否存在swapfile
grep -q &quot;swapfile&quot; /etc/fstab

#如果不存在将为其创建swap
if [ $? -ne 0 ]; then
	echo -e &quot;${Green}swapfile未发现，正在为其创建swapfile${Font}&quot;
	fallocate -l ${swapsize}M /swapfile
	chmod 600 /swapfile
	mkswap /swapfile
	swapon /swapfile
	echo '/swapfile none swap defaults 0 0' &gt;&gt; /etc/fstab
         echo -e &quot;${Green}swap创建成功，并查看信息：${Font}&quot;
         cat /proc/swaps
         cat /proc/meminfo | grep Swap
else
	echo -e &quot;${Red}swapfile已存在，swap设置失败，请先运行脚本删除swap后重新设置！${Font}&quot;
fi
}

del_swap(){
#检查是否存在swapfile
grep -q &quot;swapfile&quot; /etc/fstab

#如果存在就将其移除
if [ $? -eq 0 ]; then
	echo -e &quot;${Green}swapfile已发现，正在将其移除...${Font}&quot;
	sed -i '/swapfile/d' /etc/fstab
	echo &quot;3&quot; &gt; /proc/sys/vm/drop_caches
	swapoff -a
	rm -f /swapfile
    echo -e &quot;${Green}swap已删除！${Font}&quot;
else
	echo -e &quot;${Red}swapfile未发现，swap删除失败！${Font}&quot;
fi
}

#开始菜单
main(){
root_need
ovz_no
clear
echo -e &quot;———————————————————————————————————————&quot;
echo -e &quot;${Green}Linux VPS一键添加/删除swap脚本${Font}&quot;
echo -e &quot;${Green}1、添加swap${Font}&quot;
echo -e &quot;${Green}2、删除swap${Font}&quot;
echo -e &quot;———————————————————————————————————————&quot;
read -p &quot;请输入数字 [1-2]:&quot; num
case &quot;$num&quot; in
    1)
    add_swap
    ;;
    2)
    del_swap
    ;;
    *)
    clear
    echo -e &quot;${Green}请输入正确数字 [1-2]${Font}&quot;
    sleep 2s
    main
    ;;
    esac
}
main
</code></pre>
<p><strong>保存并命名为swap.sh</strong><br>
<code>bash swap.sh</code>即可.<br>
<code>free -m</code>查看内存.</p>
<h2 id="命令">命令</h2>
<p>docker各种镜像关系如图:<br>
<img src="https://img.hacpai.com/file/2019/08/p-2f6fd591.png" alt="p.png"></p>
<ul>
<li>利用<code>docker-compose</code>部署</li>
</ul>
<pre><code class="language-sh">wget https://raw.githubusercontent.com/Baiyuetribe/zfaka/docker/docker-compose.yml
</code></pre>
<pre><code>docker-compose up -d
</code></pre>
<p><strong>端口说明</strong></p>
<ul>
<li>ZFAKA主程序入口为：http://域名:3002 打开后填入数据库密码即可完成安装步骤。</li>
<li>phpadmin入口：http://域名:8080 用来修改数据库</li>
<li>kodexplore入口：http://域名:999 用来管理源码或替换图片等等。<br>
<strong>可能问题</strong><br>
<img src="https://img.hacpai.com/file/2019/08/68747470733a2f2f696d672e6261697975652e6f6e652f75706c6f61642f323031392f30372f356431633839363037373530322e706e67-985c198b.png" alt="68747470733a2f2f696d672e6261697975652e6f6e652f75706c6f61642f323031392f30372f356431633839363037373530322e706e67.png"></li>
</ul>

            </div>
            
              <div class="tag-container">
                
                  <a href="https://g.yzddhr.me/tag/Cy04ipSbL" class="tag">
                    技术
                  </a>
                
                  <a href="https://g.yzddhr.me/tag/ymHPLYauhe" class="tag">
                    网站搭建
                  </a>
                
              </div>
            
            
              <div class="next-post">
                <div class="next">下一篇</div>
                <a href="https://g.yzddhr.me/post/ya-li-shan-da-da-di-shi-fou-zhen-shi-cun-zai">
                  <h3 class="post-title">
                    亚历山大大帝是否真实存在
                  </h3>
                </a>
              </div>
            

            
              
                <div id="gitalk-container" data-aos="fade-in"></div>
              

              
            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>

<script type="application/javascript">

AOS.init();

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>



  
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>

      var gitalk = new Gitalk({
        clientID: '54dc0370b7c1bea2e1a8',
        clientSecret: '88000ea51dfa6cdd0a09617c30e0cdbd7397a981',
        repo: 'yzddahaoren.github.io',
        owner: 'yzddahaoren',
        admin: ['yzddahaoren'],
        id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
      })

      gitalk.render('gitalk-container')

    </script>
  

  




  </body>
</html>
